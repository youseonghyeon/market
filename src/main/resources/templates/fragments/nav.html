<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<nav th:fragment="main-nav" class="navbar navbar-expand-sm navbar-dark bg-dark" style="padding: 10px;">
    <script th:inline="javascript">
        window.onload = function () {
            // 알림 개수 query 작성
            $.ajax({
                url: "/notification/total",
                type: "GET"
            }).done(function (total) {
                if (total > 0) {
                    let element = document.getElementById('total')
                    element.hidden = false;
                    element.innerText = total;
                }
            })
        }
        const openModal = () => {
            let noticeModal = document.getElementById('notice');
            let currDisplay = noticeModal.style.display;
            if (currDisplay === 'none') {
                noticeModal.style.display = 'block';
            } else {
                noticeModal.style.display = 'none'
            }
        }
    </script>
    <a class="navbar-brand" href="/" th:href="@{/}">
        홈으로
    </a>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav justify-content-end">
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/login}">로그인</a>
            </li>
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/sign-up}">가입</a>
            </li>
            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link" th:href="@{/profile}">프로필</a>
            </li>
            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link" th:href="@{/logout}">로그아웃</a>
            </li>

            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link" th:href="@{/order/list}">주문목록/배송조회</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/product/list}">상품 목록</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" th:href="@{/product/my-list}">내상품</a>
            </li>
            <li class="nav-item position-relative">
                <a class="nav-link position-relative" onclick="openModal()">알림
                    <div class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                         id="total" hidden="hidden"></div>
                </a>
                <div id="notice" class="position-absolute" style="display: none;">
                    <div th:replace="fragments/notice::notice"></div>
                </div>
            </li>


            <li class="nav-item" sec:authorize="hasRole('ROLE_ADMIN')">
                <a class="nav-link" th:href="@{/admin/manage}">관리자</a>
            </li>

            <li class="nav-item" sec:authorize="hasRole('ROLE_COURIER')">
                <a class="nav-link" th:href="@{/delivery/list}">택배사</a>
            </li>
        </ul>
    </div>
</nav>

<nav th:fragment="admin-nav" class="navbar navbar-expand-sm navbar-dark bg-dark" style="padding: 10px;">
    <a class="navbar-brand" href="/" th:href="@{/}">
        홈으로
    </a>

    <div class="collapse navbar-collapse">
        <ul class="navbar-nav justify-content-end">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/manage}">회원 관리</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/delivery/manage}">택배사 관리</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/role}">권한 설정</a>
            </li>
        </ul>
    </div>
</nav>

<nav th:fragment="delivery-nav" class="navbar navbar-expand-sm navbar-dark bg-dark" style="padding: 10px;">
    <a class="navbar-brand" href="/" th:href="@{/}">
        홈으로
    </a>

    <div class="collapse navbar-collapse">
        <ul class="navbar-nav justify-content-end">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/delivery/list}">배송 관리</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/delivery/list}">배송 조회</a>
            </li>
        </ul>
    </div>
</nav>


</body>
</html>
